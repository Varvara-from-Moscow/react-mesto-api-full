{"ast":null,"code":"var _jsxFileName = \"/Users/varvarakorableva/Desktop/react-mesto-auth/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport { api } from '../utils/Api';\nimport Header from './Header';\nimport MyProfile from './MyProfile';\nimport Footer from './Footer';\nimport DeletePopup from './DeletePopup';\nimport ImagePopup from './ImagePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport EditProfilePopup from './EditProfilePopup';\nimport AddPlacePopup from './AddPlacePopup';\nimport Login from './Login';\nimport Register from './Register';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [cards, setCards] = React.useState([]);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n  const [isDeletePopupOpen, setIsDeletePopupOpen] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [showLoading, setShowLoading] = React.useState(false);\n  const [selectedCardToDelete, setSelectedCardToDelete] = React.useState({}); //const [loggedIn, setLoggedIn] = React.useState(false); {loggedIn ? <Redirect to=\"/my-profile\" /> : <Redirect to=\"/sign-in\" />}\n\n  React.useEffect(() => {\n    api.getInitialCards().then(cards => {\n      setCards(cards);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n  React.useEffect(() => {\n    api.getUserInfo().then(data => {\n      setCurrentUser(data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id); // Отправляем запрос в API и получаем обновлённые данные карточки\n\n    api.changeLikeStatus(card._id, !isLiked).then(newCard => {\n      setCards(state => state.map(c => c._id === card._id ? newCard : c));\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleCardDelete(card) {\n    setShowLoading(true);\n    api.deleteCard(card._id).then(() => {\n      setCards(state => state.filter(item => item !== card));\n      closeAllPopups();\n    }).catch(err => {\n      console.log(err);\n    }).finally(() => {\n      setShowLoading(false);\n    });\n  }\n\n  function handleUpdateUser(userData) {\n    setShowLoading(true);\n    api.setUserInfo(userData).then(data => {\n      setCurrentUser(data);\n      closeAllPopups();\n    }).catch(err => {\n      console.log(err);\n    }).finally(() => {\n      setShowLoading(false);\n    });\n  }\n\n  function handleUpdateAvatar(data) {\n    setShowLoading(true);\n    api.updateUserAvatar(data).then(data => {\n      setCurrentUser(data);\n      closeAllPopups();\n    }).catch(err => {\n      console.log(err);\n    }).finally(() => {\n      setShowLoading(false);\n    });\n  }\n\n  function handleAddPlaceSubmit(data) {\n    setShowLoading(true);\n    api.addUserCard(data).then(res => {\n      setCards([res, ...cards]);\n      closeAllPopups();\n    }).catch(err => {\n      console.log(err);\n    }).finally(() => {\n      setShowLoading(false);\n    });\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleDeleteCardClick(card) {\n    setIsDeletePopupOpen(true);\n    setSelectedCardToDelete(card);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsEditAvatarPopupOpen(false);\n    setIsAddPlacePopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setIsDeletePopupOpen(false);\n    setSelectedCard({});\n    setSelectedCardToDelete({});\n  }\n\n  return /*#__PURE__*/_jsxDEV(Switch, {\n    children: /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n      value: currentUser,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"page\",\n          children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/login\",\n            children: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/register\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"registerContainer\",\n              children: /*#__PURE__*/_jsxDEV(Register, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/my-profile\",\n            children: [/*#__PURE__*/_jsxDEV(MyProfile, {\n              onEditProfile: handleEditProfileClick,\n              onAddPlace: handleAddPlaceClick,\n              onEditAvatar: handleEditAvatarClick,\n              onCardClick: handleCardClick,\n              onCardLike: handleCardLike,\n              onTrashButton: handleDeleteCardClick,\n              cards: cards\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n            isOpen: isAddPlacePopupOpen,\n            onClose: closeAllPopups,\n            onAddPlace: handleAddPlaceSubmit,\n            showLoading: showLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n            isOpen: isEditProfilePopupOpen,\n            onClose: closeAllPopups,\n            onUpdateUser: handleUpdateUser,\n            showLoading: showLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n            isOpen: isEditAvatarPopupOpen,\n            onClose: closeAllPopups,\n            onUpdateAvatar: handleUpdateAvatar,\n            showLoading: showLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(DeletePopup, {\n            isOpen: isDeletePopupOpen,\n            onClose: closeAllPopups,\n            onCardDelete: handleCardDelete,\n            showLoading: showLoading,\n            card: selectedCardToDelete\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n            card: selectedCard,\n            onClose: closeAllPopups\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 154,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"d0TgqYPDxVsP9++fZ4yWNBiWBIw=\");\n\n_c = App;\nexport default App;\n/*\nuseEffect(() => {\n        if (loggedIn) {\n            Запрос на получение карточек\n            Запрос на получение данных о пользователе\n        }\n    }, [loggedIn]);\n*/\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/varvarakorableva/Desktop/react-mesto-auth/src/components/App.js"],"names":["React","BrowserRouter","Route","Switch","Redirect","CurrentUserContext","api","Header","MyProfile","Footer","DeletePopup","ImagePopup","EditAvatarPopup","EditProfilePopup","AddPlacePopup","Login","Register","App","cards","setCards","useState","currentUser","setCurrentUser","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isDeletePopupOpen","setIsDeletePopupOpen","selectedCard","setSelectedCard","showLoading","setShowLoading","selectedCardToDelete","setSelectedCardToDelete","useEffect","getInitialCards","then","catch","err","console","log","getUserInfo","data","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeStatus","newCard","state","map","c","handleCardDelete","deleteCard","filter","item","closeAllPopups","finally","handleUpdateUser","userData","setUserInfo","handleUpdateAvatar","updateUserAvatar","handleAddPlaceSubmit","addUserCard","res","handleCardClick","handleDeleteCardClick","handleEditProfileClick","handleAddPlaceClick","handleEditAvatarClick"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom';\nimport {CurrentUserContext} from '../contexts/CurrentUserContext';\nimport {api} from '../utils/Api';\nimport Header from './Header';\nimport MyProfile from './MyProfile';\nimport Footer from './Footer';\nimport DeletePopup from './DeletePopup';\nimport ImagePopup from './ImagePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport EditProfilePopup from './EditProfilePopup';\nimport AddPlacePopup from './AddPlacePopup';\nimport Login from './Login';\nimport Register from './Register';\n\nfunction App() {\n  const [cards, setCards] = React.useState([]);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n  const [isDeletePopupOpen, setIsDeletePopupOpen] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [showLoading, setShowLoading] = React.useState(false);\n  const [selectedCardToDelete, setSelectedCardToDelete] = React.useState({});\n  //const [loggedIn, setLoggedIn] = React.useState(false); {loggedIn ? <Redirect to=\"/my-profile\" /> : <Redirect to=\"/sign-in\" />}\n\n  React.useEffect(() => {\n    api.getInitialCards()\n    .then((cards) => {\n      setCards(cards);\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n  },[]);\n\n  React.useEffect(() => {\n    api.getUserInfo()\n    .then((data) => {\n      setCurrentUser(data);\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n  },[]);\n\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    api.changeLikeStatus(card._id, !isLiked)\n        .then((newCard) => {\n          setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n  } \n\n\n  function handleCardDelete(card) {\n    setShowLoading(true);\n    api.deleteCard(card._id)\n      .then(() => {\n        setCards((state) => state.filter((item) => item !== card))\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleUpdateUser(userData) {\n    setShowLoading(true);\n    api.setUserInfo(userData)\n      .then((data) => {\n        setCurrentUser(data);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleUpdateAvatar(data) {\n    setShowLoading(true);\n    api.updateUserAvatar(data)\n      .then((data) => {\n        setCurrentUser(data);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleAddPlaceSubmit(data) {\n    setShowLoading(true);\n    api.addUserCard(data)\n      .then((res) => {\n        setCards([res, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleDeleteCardClick(card) {\n    setIsDeletePopupOpen(true);\n    setSelectedCardToDelete(card);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsEditAvatarPopupOpen(false)\n    setIsAddPlacePopupOpen(false)\n    setIsEditProfilePopupOpen(false)\n    setIsDeletePopupOpen(false)\n    setSelectedCard({})\n    setSelectedCardToDelete({})\n  }\n\n  return (\n    <Switch>\n    <CurrentUserContext.Provider value={currentUser}>\n    <div className=\"body\">\n    <div className=\"page\">\n      \n      <Header />\n\n      <Route exact path=\"/\">\n        \n      </Route>\n\n      <Route path=\"/login\">\n            <Login  />\n      </Route>\n      <Route path=\"/register\">\n          <div className=\"registerContainer\">\n            <Register />\n          </div>\n      </Route>\n\n      <Route path=\"/my-profile\">\n        <MyProfile\n          onEditProfile={handleEditProfileClick}\n          onAddPlace={handleAddPlaceClick}\n          onEditAvatar={handleEditAvatarClick} \n          onCardClick={handleCardClick}\n          onCardLike={handleCardLike}\n          onTrashButton={handleDeleteCardClick}\n          cards={cards}/>\n        <Footer />\n      </Route>\n\n      <AddPlacePopup \n      isOpen={isAddPlacePopupOpen}\n      onClose={closeAllPopups}\n      onAddPlace={handleAddPlaceSubmit}\n      showLoading={showLoading}/>\n\n      <EditProfilePopup \n      isOpen={isEditProfilePopupOpen} \n      onClose={closeAllPopups} \n      onUpdateUser={handleUpdateUser}\n      showLoading={showLoading}/>\n\n      <EditAvatarPopup \n      isOpen={isEditAvatarPopupOpen} \n      onClose={closeAllPopups} \n      onUpdateAvatar={handleUpdateAvatar}\n      showLoading={showLoading}/> \n\n      <DeletePopup \n      isOpen={isDeletePopupOpen}\n      onClose={closeAllPopups}\n      onCardDelete={handleCardDelete}\n      showLoading={showLoading}\n      card={selectedCardToDelete}/>\n\n      <ImagePopup \n      card={selectedCard}\n      onClose={closeAllPopups}\n      />\n\n    </div>\n    </div>\n    </CurrentUserContext.Provider>\n    </Switch>\n  );\n}\nexport default App;\n\n\n/*\nuseEffect(() => {\n        if (loggedIn) {\n            Запрос на получение карточек\n            Запрос на получение данных о пользователе\n        }\n    }, [loggedIn]);\n*/"]},"metadata":{},"sourceType":"module"}