{"ast":null,"code":"import _toConsumableArray from\"/Users/varvarakorableva/mesto-react/react_mesto/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/varvarakorableva/mesto-react/react_mesto/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{api}from'../utils/Api';import Header from'./Header';import Main from'./Main';import Footer from'./Footer';import PopupWithForm from'./PopupWithForm';import ImagePopup from'./ImagePopup';import EditAvatarPopup from'./EditAvatarPopup';import EditProfilePopup from'./EditProfilePopup';import AddPlacePopup from'./AddPlacePopup';import{CurrentUserContext}from'../contexts/CurrentUserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),cards=_React$useState2[0],setCards=_React$useState2[1];var _React$useState3=React.useState({}),_React$useState4=_slicedToArray(_React$useState3,2),currentUser=_React$useState4[0],setCurrentUser=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isEditProfilePopupOpen=_React$useState6[0],setIsEditProfilePopupOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isAddPlacePopupOpen=_React$useState8[0],setIsAddPlacePopupOpen=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isEditAvatarPopupOpen=_React$useState10[0],setIsEditAvatarPopupOpen=_React$useState10[1];var _React$useState11=React.useState({}),_React$useState12=_slicedToArray(_React$useState11,2),selectedCard=_React$useState12[0],setSelectedCard=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),showLoading=_React$useState14[0],setShowLoading=_React$useState14[1];React.useEffect(function(){api.getInitialCards().then(function(cards){setCards(cards);}).catch(function(err){console.log(err);});},[]);React.useEffect(function(){api.getUserInfo().then(function(data){setCurrentUser(data);}).catch(function(err){console.log(err);});},[]);function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\napi.changeLikeStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(item){return item!==card;});});}).catch(function(err){console.log(err);});}function handleUpdateUser(userData){setShowLoading(true);api.setUserInfo(userData).then(function(data){setCurrentUser(data);closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setShowLoading(false);});}function handleUpdateAvatar(data){setShowLoading(true);api.updateUserAvatar(data).then(function(data){setCurrentUser(data);closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setShowLoading(false);});}function handleAddPlaceSubmit(data){setShowLoading(true);api.addUserCard(data).then(function(res){setCards([res].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setShowLoading(false);});}function handleCardClick(card){setSelectedCard(card);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function closeAllPopups(){setIsEditAvatarPopupOpen(false);setIsAddPlacePopupOpen(false);setIsEditProfilePopupOpen(false);setSelectedCard({});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsx(\"div\",{className:\"body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,onCardLike:handleCardLike,onCardDelete:handleCardDelete,cards:cards}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit,showLoading:showLoading}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser,showLoading:showLoading}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar,showLoading:showLoading}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"areYouSureToDelete\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",submitName:\"\\u0414\\u0430\",onClose:closeAllPopups}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups})]})})});}export default App;","map":{"version":3,"sources":["/Users/varvarakorableva/mesto-react/react_mesto/src/components/App.js"],"names":["React","api","Header","Main","Footer","PopupWithForm","ImagePopup","EditAvatarPopup","EditProfilePopup","AddPlacePopup","CurrentUserContext","App","useState","cards","setCards","currentUser","setCurrentUser","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","selectedCard","setSelectedCard","showLoading","setShowLoading","useEffect","getInitialCards","then","catch","err","console","log","getUserInfo","data","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeStatus","newCard","state","map","c","handleCardDelete","deleteCard","filter","item","handleUpdateUser","userData","setUserInfo","closeAllPopups","finally","handleUpdateAvatar","updateUserAvatar","handleAddPlaceSubmit","addUserCard","res","handleCardClick","handleEditProfileClick","handleAddPlaceClick","handleEditAvatarClick"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {api} from '../utils/Api';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport PopupWithForm from './PopupWithForm';\nimport ImagePopup from './ImagePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport EditProfilePopup from './EditProfilePopup';\nimport AddPlacePopup from './AddPlacePopup';\nimport {CurrentUserContext} from '../contexts/CurrentUserContext';\n\nfunction App() {\n  const [cards, setCards] = React.useState([]);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [showLoading, setShowLoading] = React.useState(false);\n\n  React.useEffect(() => {\n    api.getInitialCards()\n    .then((cards) => {\n      setCards(cards);\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n  },[]);\n\n  React.useEffect(() => {\n    api.getUserInfo()\n    .then((data) => {\n      setCurrentUser(data);\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n  },[]);\n\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    api.changeLikeStatus(card._id, !isLiked)\n        .then((newCard) => {\n          setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n  } \n\n\n  function handleCardDelete(card) {\n    api.deleteCard(card._id)\n      .then(() => {\n        setCards((state) => state.filter((item) => item !== card))\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n  }\n\n  function handleUpdateUser(userData) {\n    setShowLoading(true);\n    api.setUserInfo(userData)\n      .then((data) => {\n        setCurrentUser(data);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleUpdateAvatar(data) {\n    setShowLoading(true);\n    api.updateUserAvatar(data)\n      .then((data) => {\n        setCurrentUser(data);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleAddPlaceSubmit(data) {\n    setShowLoading(true);\n    api.addUserCard(data)\n      .then((res) => {\n        setCards([res, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n      .finally(() => {\n        setShowLoading(false);\n    })\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsEditAvatarPopupOpen(false); \n    setIsAddPlacePopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setSelectedCard({});\n  }\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n    <div className=\"body\">\n    <div className=\"page\">\n      <Header />\n      <Main\n      onEditProfile={handleEditProfileClick}\n      onAddPlace={handleAddPlaceClick}\n      onEditAvatar={handleEditAvatarClick} \n      onCardClick={handleCardClick}\n      onCardLike={handleCardLike}\n      onCardDelete={handleCardDelete}\n      cards={cards}\n      />\n      <Footer />\n\n      <AddPlacePopup \n      isOpen={isAddPlacePopupOpen}\n      onClose={closeAllPopups}\n      onAddPlace={handleAddPlaceSubmit}\n      showLoading={showLoading}/>\n\n      <EditProfilePopup \n      isOpen={isEditProfilePopupOpen} \n      onClose={closeAllPopups} \n      onUpdateUser={handleUpdateUser}\n      showLoading={showLoading}/>\n\n      <EditAvatarPopup \n      isOpen={isEditAvatarPopupOpen} \n      onClose={closeAllPopups} \n      onUpdateAvatar={handleUpdateAvatar}\n      showLoading={showLoading}/> \n\n      <PopupWithForm \n      name=\"areYouSureToDelete\"\n      title=\"Вы уверены?\"\n      submitName=\"Да\"\n      onClose={closeAllPopups}\n      />\n      <ImagePopup \n        card={selectedCard}\n        onClose={closeAllPopups}\n      />\n    </div>\n    </div>\n    </CurrentUserContext.Provider>\n  );\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}